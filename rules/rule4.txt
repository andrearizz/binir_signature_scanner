def xor_encr:
    matches:
        $xor = "?? = Xor32(??,??)"
        $y = "?? = ??64(??,??)"
        $z = "?? = ??32(??,??)"
        $x1 = "?? = Cmp??U(??,??)"
        $x2 = "?? = 1Uto??(??)"
        $x3 = "?? = ??to1(??)"
        $s1 = "execve"
        $s2 = "socket"
        $s3 = "connect"
    condition:
        (({$y 1 $y 1 $xor} or {$z 1 $z 1 $xor}) and {$x1 0 $x2 0 $x3}) and all of ($s1 $s2 $s3)


